/**
 * Generated Slack Calls Service
 * DO NOT EDIT - This file is auto-generated by scripts/generate-services.ts
 */

import { Effect } from "effect"
import type {
  CallsAddArguments,
  CallsAddResponse,
  CallsEndArguments,
  CallsEndResponse,
  CallsInfoArguments,
  CallsInfoResponse,
  CallsParticipantsAddArguments,
  CallsParticipantsAddResponse,
  CallsParticipantsRemoveArguments,
  CallsParticipantsRemoveResponse,
  CallsUpdateArguments,
  CallsUpdateResponse
} from "@slack/web-api"
import { SlackClient } from "../SlackClient.js"
import { mapSlackError, annotateSpanWithError, type SlackError } from "../internal/errors.js"

export class CallsService extends Effect.Service<CallsService>()("effect-slack/CallsService", {
  effect: Effect.gen(function* () {
    const client = yield* SlackClient

    /**
     * Registers a new Call.
     */
    const add = (
      args: CallsAddArguments
    ): Effect.Effect<CallsAddResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.calls.add(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("CallsService.add", {
          attributes: { "slack.method": "calls.add" }
        })
      )

    /**
     * Ends a Call.
     */
    const end = (
      args: CallsEndArguments
    ): Effect.Effect<CallsEndResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.calls.end(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("CallsService.end", {
          attributes: { "slack.method": "calls.end" }
        })
      )

    /**
     * Returns information about a Call.
     */
    const info = (
      args: CallsInfoArguments
    ): Effect.Effect<CallsInfoResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.calls.info(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("CallsService.info", {
          attributes: { "slack.method": "calls.info" }
        })
      )

    /**
     * Updates information about a Call.
     */
    const update = (
      args: CallsUpdateArguments
    ): Effect.Effect<CallsUpdateResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.calls.update(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("CallsService.update", {
          attributes: { "slack.method": "calls.update" }
        })
      )

    /**
     * Registers new participants added to a Call.
     */
    const ParticipantsAdd = (
      args: CallsParticipantsAddArguments
    ): Effect.Effect<CallsParticipantsAddResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.calls.participants.add(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("CallsService.participants.add", {
          attributes: { "slack.method": "calls.participants.add" }
        })
      )

    const ParticipantsRemove = (
      args: CallsParticipantsRemoveArguments
    ): Effect.Effect<CallsParticipantsRemoveResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.calls.participants.remove(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("CallsService.participants.remove", {
          attributes: { "slack.method": "calls.participants.remove" }
        })
      )

    return {
      add,
      end,
      info,
      update,
      participants: {
        add: ParticipantsAdd,
        remove: ParticipantsRemove
      }
    } as const
  }),
  dependencies: [SlackClient.Default]
}) {}
