/**
 * Generated Slack Workflows Service
 * DO NOT EDIT - This file is auto-generated by scripts/generate-services.ts
 */

import { Effect } from "effect"
import type {
  WebAPICallResult,
  WorkflowsFeaturedAddArguments,
  WorkflowsFeaturedListArguments,
  WorkflowsFeaturedListResponse,
  WorkflowsFeaturedRemoveArguments,
  WorkflowsFeaturedSetArguments,
  WorkflowsStepCompletedArguments,
  WorkflowsStepCompletedResponse,
  WorkflowsStepFailedArguments,
  WorkflowsStepFailedResponse,
  WorkflowsUpdateStepArguments,
  WorkflowsUpdateStepResponse
} from "@slack/web-api"
import { SlackClient } from "../SlackClient.js"
import { mapSlackError, annotateSpanWithError, type SlackError } from "../internal/errors.js"

export class WorkflowsService extends Effect.Service<WorkflowsService>()("effect-slack/WorkflowsService", {
  effect: Effect.gen(function* () {
    const client = yield* SlackClient

    /**
     * Indicate that an app's step in a workflow completed execution.
     * @deprecated
     */
    const stepCompleted = (
      args: WorkflowsStepCompletedArguments
    ): Effect.Effect<WorkflowsStepCompletedResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.stepCompleted(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.stepCompleted", {
          attributes: { "slack.method": "workflows.stepCompleted" }
        })
      )

    /**
     * Indicate that an app's step in a workflow failed to execute.
     * @deprecated
     */
    const stepFailed = (
      args: WorkflowsStepFailedArguments
    ): Effect.Effect<WorkflowsStepFailedResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.stepFailed(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.stepFailed", {
          attributes: { "slack.method": "workflows.stepFailed" }
        })
      )

    /**
     * Update the configuration for a workflow step.
     * @deprecated
     */
    const updateStep = (
      args: WorkflowsUpdateStepArguments
    ): Effect.Effect<WorkflowsUpdateStepResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.updateStep(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.updateStep", {
          attributes: { "slack.method": "workflows.updateStep" }
        })
      )

    /**
     * Add featured workflows to a channel.
     */
    const FeaturedAdd = (
      args: WorkflowsFeaturedAddArguments
    ): Effect.Effect<WebAPICallResult, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.featured.add(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.featured.add", {
          attributes: { "slack.method": "workflows.featured.add" }
        })
      )

    /**
     * List the featured workflows for specified channels.
     */
    const FeaturedList = (
      args: WorkflowsFeaturedListArguments
    ): Effect.Effect<WorkflowsFeaturedListResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.featured.list(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.featured.list", {
          attributes: { "slack.method": "workflows.featured.list" }
        })
      )

    /**
     * Remove featured workflows from a channel.
     */
    const FeaturedRemove = (
      args: WorkflowsFeaturedRemoveArguments
    ): Effect.Effect<WebAPICallResult, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.featured.remove(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.featured.remove", {
          attributes: { "slack.method": "workflows.featured.remove" }
        })
      )

    /**
     * Set featured workflows for a channel.
     */
    const FeaturedSet = (
      args: WorkflowsFeaturedSetArguments
    ): Effect.Effect<WebAPICallResult, SlackError> =>
      Effect.tryPromise({
        try: () => client.workflows.featured.set(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("WorkflowsService.featured.set", {
          attributes: { "slack.method": "workflows.featured.set" }
        })
      )

    return {
      stepCompleted,
      stepFailed,
      updateStep,
      featured: {
        add: FeaturedAdd,
        list: FeaturedList,
        remove: FeaturedRemove,
        set: FeaturedSet
      }
    } as const
  }),
  dependencies: [SlackClient.Default]
}) {}
