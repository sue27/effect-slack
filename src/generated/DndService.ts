/**
 * Generated Slack Dnd Service
 * DO NOT EDIT - This file is auto-generated by scripts/generate-services.ts
 */

import { Effect } from "effect"
import type {
  DndEndDndArguments,
  DndEndDndResponse,
  DndEndSnoozeArguments,
  DndEndSnoozeResponse,
  DndInfoArguments,
  DndInfoResponse,
  DndSetSnoozeArguments,
  DndSetSnoozeResponse,
  DndTeamInfoArguments,
  DndTeamInfoResponse
} from "@slack/web-api"
import { SlackClient } from "../SlackClient.js"
import { mapSlackError, annotateSpanWithError, type SlackError } from "../internal/errors.js"

export class DndService extends Effect.Service<DndService>()("effect-slack/DndService", {
  effect: Effect.gen(function* () {
    const client = yield* SlackClient

    /**
     * Ends the current user's Do Not Disturb session immediately.
     */
    const endDnd = (
      args?: DndEndDndArguments
    ): Effect.Effect<DndEndDndResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.dnd.endDnd(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("DndService.endDnd", {
          attributes: { "slack.method": "dnd.endDnd" }
        })
      )

    /**
     * Ends the current user's snooze mode immediately.
     */
    const endSnooze = (
      args?: DndEndSnoozeArguments
    ): Effect.Effect<DndEndSnoozeResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.dnd.endSnooze(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("DndService.endSnooze", {
          attributes: { "slack.method": "dnd.endSnooze" }
        })
      )

    /**
     * Retrieves a user's current Do Not Disturb status.
     */
    const info = (
      args?: DndInfoArguments
    ): Effect.Effect<DndInfoResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.dnd.info(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("DndService.info", {
          attributes: { "slack.method": "dnd.info" }
        })
      )

    /**
     * Turns on Do Not Disturb mode for the current user, or changes its duration.
     */
    const setSnooze = (
      args: DndSetSnoozeArguments
    ): Effect.Effect<DndSetSnoozeResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.dnd.setSnooze(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("DndService.setSnooze", {
          attributes: { "slack.method": "dnd.setSnooze" }
        })
      )

    /**
     * Retrieves the Do Not Disturb status for up to 50 users on a team.
     */
    const teamInfo = (
      args: DndTeamInfoArguments
    ): Effect.Effect<DndTeamInfoResponse, SlackError> =>
      Effect.tryPromise({
        try: () => client.dnd.teamInfo(args),
        catch: mapSlackError
      }).pipe(
        Effect.tapError(annotateSpanWithError),
        Effect.withSpan("DndService.teamInfo", {
          attributes: { "slack.method": "dnd.teamInfo" }
        })
      )

    return {
      endDnd,
      endSnooze,
      info,
      setSnooze,
      teamInfo
    } as const
  }),
  dependencies: [SlackClient.Default]
}) {}
